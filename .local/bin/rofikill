#!/bin/dash

ps="$(ps -eHo pid,ppid,comm)"
header="$(echo "$ps" | awk 'NR==1')"

process="$(\
echo "$ps" | awk 'NR!=1' |
rofi -dmenu -cycle -mesg "$header" -matching regex -p kill
)" || exit

if [ ! -z "$process" ]; then
  pid="$(echo "$process" | awk 'NR==1 {print $1}')"
  name="$(echo "$process" | awk 'NR==1 {print $3}')"
  kill "$pid" && notify-send "Killed $name"
fi
